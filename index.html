<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GitHub 资源加速工具</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; font-family: "Arial", "Microsoft YaHei", sans-serif; }
        body { max-width: 800px; margin: 0 auto; padding: 20px; background: #f5f5f5; }
        .container { background: #fff; padding: 30px; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
        h1 { color: #24292e; margin-bottom: 20px; font-size: 24px; text-align: center; }
        .desc { color: #666; margin-bottom: 25px; line-height: 1.6; }
        .input-group { display: flex; gap: 10px; margin-bottom: 20px; }
        #githubUrl { flex: 1; padding: 12px 15px; border: 1px solid #ddd; border-radius: 4px; font-size: 16px; outline: none; }
        #githubUrl:focus { border-color: #0366d6; box-shadow: 0 0 0 3px rgba(3,102,214,0.1); }
        #加速按钮 { padding: 12px 25px; background: #0366d6; color: #fff; border: none; border-radius: 4px; font-size: 16px; cursor: pointer; }
        #加速按钮:hover { background: #0256b3; }
        .supported { margin-top: 30px; }
        h3 { color: #24292e; margin: 15px 0 8px; font-size: 18px; }
        ul { color: #666; padding-left: 20px; line-height: 1.6; }
        .result { margin-top: 20px; padding: 15px; border-radius: 4px; display: none; }
        .success { background: #e6ffed; border: 1px solid #a3e6b1; }
        .error { background: #ffebe9; border: 1px solid #ffcecc; }
        #resultText { color: #24292e; line-height: 1.6; }
        #copyBtn { margin-top: 10px; padding: 8px 15px; background: #f5f5f5; border: 1px solid #ddd; border-radius: 4px; cursor: pointer; }
    </style>
</head>
<body>
    <div class="container">
        <h1>GitHub 资源加速工具</h1>
        <p class="desc">
            输入 GitHub 相关链接（如 Releases、Blob、Raw 文件等），点击加速按钮生成代理链接，解决国内访问缓慢问题。
        </p>

        <!-- 输入和按钮区域 -->
        <div class="input-group">
            <input 
                type="text" 
                id="githubUrl" 
                placeholder="示例：https://github.com/用户名/仓库名/releases 或 https://raw.githubusercontent.com/..."
            >
            <button id="加速按钮">生成加速链接</button>
        </div>

        <!-- 结果显示区域 -->
        <div class="result" id="resultBox">
            <p id="resultText"></p>
            <button id="copyBtn">复制加速链接</button>
        </div>

        <!-- 支持的链接类型说明 -->
        <div class="supported">
            <h3>✅ 支持加速的链接类型</h3>
            <ul>
                <li>GitHub Releases 下载：https://github.com/用户名/仓库名/releases</li>
                <li>Blob 源码页面：https://github.com/用户名/仓库名/blob/分支/文件路径</li>
                <li>Raw 原始文件：https://raw.githubusercontent.com/用户名/仓库名/分支/文件路径</li>
                <li>Gist 代码片段：https://gist.github.com/用户名/ID 或 https://gist.githubusercontent.com/...</li>
                <li>仓库 Tags 页面：https://github.com/用户名/仓库名/tags</li>
            </ul>

            <h3>⚠️ 使用说明</h3>
            <ul>
                <li>生成的加速链接可直接复制到浏览器地址栏访问，或用于下载工具（如 wget、curl）</li>
                <li>若链接无法访问，可检查原链接是否有效（非 GitHub 链接不支持加速）</li>
            </ul>
        </div>
    </div>

    <script>
        // 配置（与原代理逻辑一致）
        const PROXY_PREFIX = 'https://hunshcn.github.io/gh-proxy/'; // 代理前缀
        const Config = { jsdelivr: 0 }; // 0=关闭jsDelivr镜像，1=开启

        // DOM 元素
        const githubUrlInput = document.getElementById('githubUrl');
        const加速Btn = document.getElementById('加速按钮');
        const resultBox = document.getElementById('resultBox');
        const resultText = document.getElementById('resultText');
        const copyBtn = document.getElementById('copyBtn');

        // 检查链接是否符合 GitHub 支持类型（原逻辑正则）
        function checkGithubUrl(url) {
            const exps = [
                /^(?:https?:\/\/)?github\.com\/.+?\/.+?\/(?:releases|archive)\/.*$/i,
                /^(?:https?:\/\/)?github\.com\/.+?\/.+?\/(?:blob|raw)\/.*$/i,
                /^(?:https?:\/\/)?github\.com\/.+?\/.+?\/(?:info|git-).*$/i,
                /^(?:https?:\/\/)?raw\.(?:githubusercontent|github)\.com\/.+?\/.+?\/.+?\/.+$/i,
                /^(?:https?:\/\/)?gist\.(?:githubusercontent|github)\.com\/.+?\/.+?\/.+$/i,
                /^(?:https?:\/\/)?github\.com\/.+?\/.+?\/tags.*$/i
            ];
            return exps.some(exp => exp.test(url));
        }

        // 生成加速链接（核心逻辑）
        function generateProxyUrl(originalUrl) {
            let url = originalUrl.trim();
            // 处理 Blob 链接（根据 jsdelivr 配置）
            if (url.match(/^(?:https?:\/\/)?github\.com\/.+?\/.+?\/blob\/.*$/i)) {
                if (Config.jsdelivr) {
                    // 走 jsDelivr 镜像
                    return url.replace('/blob/', '@').replace(/^(?:https?:\/\/)?github\.com/, 'https://cdn.jsdelivr.net/gh');
                } else {
                    // 转 Raw 链接后走代理
                    url = url.replace('/blob/', '/raw/');
                }
            }
            // 其他类型链接直接拼接代理前缀
            return PROXY_PREFIX + url;
        }

        // 加速按钮点击事件
        加速Btn.addEventListener('click', () => {
            const originalUrl = githubUrlInput.value.trim();
            // 验证输入
            if (!originalUrl) {
                showResult('请输入 GitHub 相关链接', 'error');
                return;
            }
            if (!checkGithubUrl(originalUrl)) {
                showResult('不支持的链接类型！请输入 GitHub Releases/Blob/Raw/Gist 链接', 'error');
                return;
            }
            // 生成并显示加速链接
            const proxyUrl = generateProxyUrl(originalUrl);
            showResult(`加速链接已生成：<br><br><strong>${proxyUrl}</strong>`, 'success');
            // 存储链接用于复制
            copyBtn.dataset.url = proxyUrl;
        });

        // 复制按钮点击事件
        copyBtn.addEventListener('click', () => {
            const proxyUrl = copyBtn.dataset.url;
            if (proxyUrl) {
                navigator.clipboard.writeText(proxyUrl).then(() => {
                    alert('加速链接已复制到剪贴板！');
                }).catch(() => {
                    alert('复制失败，请手动复制链接');
                });
            }
        });

        // 显示结果（成功/错误）
        function showResult(text, type) {
            resultText.innerHTML = text;
            resultBox.className = `result ${type}`;
            resultBox.style.display = 'block';
        }

        // 回车键触发加速
        githubUrlInput.addEventListener('keydown', (e) => {
            if (e.key === 'Enter') {
                加速Btn.click();
            }
        });
    </script>
</body>
</html>